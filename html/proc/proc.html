

<a name=/proc>
<h2>procs</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/var>vars (procs)</a>
<dd><a href=#/proc/arguments>arguments (proc)</a>
<dd><a href=#/area/proc>procs (area)</a>
<dd><a href=#/mob/proc>procs (mob)</a>
<dd><a href=#/obj/proc>procs (obj)</a>
<dd><a href=#/turf/proc>procs (turf)</a>
</dl>

<p>Procs may be derived from /proc.  These procs are "global", in that they
can be called anywhere in the code.

<h3>Example:</h3>
<xmp>
proc/poof()
    world << "POOF!"
</xmp>

<p>The proc <tt>poof()</tt> may now be called anywhere in the code.

<p>Procs may also be attached to objects by defining them under the
appropriate <tt>object/proc</tt> subnode.  Currently DM allows procs to be
defined or overridden for <tt>/mob</tt>, <tt>/obj</tt>, <tt>/turf</tt>,
<tt>/area</tt>, <tt>world</tt>, and <tt>/client</tt>, as well as for
<a href=#/datum>datum objects</a> derived from <tt>/</tt>. Predefined procs
are discussed under the "procs" entry for the object type.

<h3>Example:</h3>
<xmp>
mob/proc/poof()
    world << "POOF!"
</xmp>

<p>This can be called by a mob var M, using <tt>M.poof()</tt>.

<h3>Return types</h3>

<p>It is possible to define what type of value a proc is expected to return,
by following its definition with an <tt>as</tt> clause. This can be a type
path, such as <tt>as /mob/player</tt>, or a more intrinsic type like <tt>as
num</tt> or <tt>as list</tt>.

<h3>Example:</h3>
<xmp>
mob/monster
    var/mob/player/target

    proc/GetTarget() as /mob/player
        if(!target)
            // find a /mob/player in view
            target = locate() in view(src)
        return target
</xmp>

<p>Currently the only purpose for using the <tt>as</tt> clause is for
situations where the compiler needs to infer the type of an expression.
Mainly this applies to the <a class=code href=#/operator/%2e>.</a> and
<a class=code href=#/operator/%3f%2e>?.</a> operators in an expression
such as <tt>GetTarget()?.Attack(src)</tt>. Giving <tt>GetTarget()</tt>
a return type allows the compiler to check if <tt>Attack()</tt> is a
valid proc for <tt>/mob/player</tt>. Otherwise, the <tt>.</tt> and
<tt>?.</tt> operators act like <tt>:</tt> and <tt>?:</tt>,
respectively; the compiler won't do any checking to see if
<tt>Attack()</tt> is valid.

