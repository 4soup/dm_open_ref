

<a name=/proc/json_encode>
<h2 byondver=510>json_encode proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/json_decode>json_decode proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>json_encode(Value)
<dd byondver=515>json_encode(Value, flags)
</dl>

<dl><dt><b>Returns:</b>
<dd>A JSON-formatted text string representing Value.
</dl>

<dl><dt><b>Args:</b>
<dd>Value: The value to encode.
<dd>flags: A set of flags that tell the encoder how to act.
</dl>

<p>If Value is a simple list or a matrix, the result will be formatted as a
JSON array, and each item in the list is encoded.

<p>If Value is an associative list, the result will be formatted as a JSON
object literal, and each item and associated value is encoded. (The keys in
the object literal don't have to be strings. Even though that isn't valid
JSON, BYOND doesn't care. Be aware however that strict JSON parsers
<i>will</i> care.)

<p>Datums are <i>not</i> serialized, but are converted to the equivalent of
<tt>"[Value]"</tt> instead.

<p>The special numbers NaN and infinity will be encoded as object literals
in a form like <tt>{"__number__":"NaN"}</tt>.

<h3>Example:</h3>
<xmp>
var/list/info = list("name"="fridge", "power"=12)
// send {"name":"fridge","power":12} to a JavaScript function
usr << output(url_encode(json_encode(info)), "mybrowser:myJSfunction")
</xmp>

<p>BYOND formatting such as \red is removed from encoded strings.

<p>Situations where a list has a reference to itself will cause the nested
version to print a null value instead.

<p>The <tt>JSON_PRETTY_PRINT</tt> flag introduces spacing into the output for
improved readibility. Spaces will be added after colons and commas. Non-empty
arrays and object literals will have a line break and tabs before each item,
and a line break with one fewer tab before the closing bracket or brace. (The
special formatting for numbers like Infinity, or the list form for matrices,
will not be given tabs and line breaks.)

