

<a name=/proc/var/usr>
<h2>usr var (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/var/src>src var (proc)</a>
<dd><a href=#/verb>verbs</a>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/proc/range>range proc</a>
<dd><a href=#/proc/view>view proc</a>
<dd><a href=#/proc/alert>alert proc</a>
<dd><a href=#/proc/input>input proc</a>
</dl>

<p>This is a mob variable (var/mob/usr) containing the mob of the player who
executed the current verb, or whose action ultimately called the current
proc.

<h3>Example:</h3>
<xmp>
obj/bread
  verb/eat()
    world << "[usr] eats [src]"
</xmp>

<p>If a player named "Bob" calls "eat bread", the output will be "Bob eats
the bread."

<p>Essentially, <tt>usr</tt> is an implicit parameter that is passed to every
proc or verb.  Each procedure inherits the value from its caller.  While it
can simplify your code in some situations, it can also lead to subtle problems
if you are assuming that <tt>usr</tt> is automatically assigned the value of
<tt>src</tt> when you call a verb programmatically.  It is not.

<p>The only time <tt>usr</tt> is assigned for you is when a player executes a
verb, clicks something with the mouse, clicks a link (see
<a class=code href=#/client/proc/Topic>Topic</a>), or any other such action.

<p class=tip>Note: <b>A good rule of thumb is to never put usr in a proc, only
verbs.</b> Typically <tt>usr</tt> in a proc is an unsafe programming practice.
If <tt>src</tt> would not be the correct choice, it is better to send another
argument to your proc with the information it needs.

<p>Certain built-in procs such as
<a class=code href=#/atom/proc/Click>atom/Click()</a> are called automatically
by a client counterpart like
<a class=code href=#/client/proc/Click>client/Click()</a>; usually
<a class=code href=#/atom/proc/Click>atom/Stat()</a> is called by
<a class=code href=#/client/proc/Click>client/Stat()</a>; and so on. It is
mostly safe to apply <tt>usr</tt> as directed in those situations, because
these procs are pseudo-verbs. It is mostly <em>not</em> safe to apply
<tt>usr</tt> in a movement proc such as
<a class=code href=#/atom/movable/proc/Move>Move()</a> or
<a class=code href=#/atom/proc/Enter>Enter()</a>, because objs and non-player
mobs may move autonomously without setting <tt>usr</tt>.

<p>Although <tt>usr</tt> is often set in <a href=#/mob/proc/Login>mob/Login()</a>
when a client first connects, you should not assume it is valid if
<tt>Login()</tt> is called any other way. Common cases occur when creating a
new character, loading a player's mob from a savefile; or explicitly when
setting a mob's key or changing the value of
<a class=code href=#/client/var/mob>client.mob</a>. It is safest to use
<tt>src</tt> in <tt>mob/Login()</tt>, which is always correct, rather than
<tt>usr</tt>.

<p><tt>usr</tt> is the default point of reference for several procs like
<a class=code href=#/proc/view>view()</a> and
<a class=code href=#/proc/range>range()</a>, because of their common use in
verbs. It is also the default recipient for
<a class=code href=#/proc/input>input()</a> and
<a class=code href=#/proc/alert>alert()</a> messages. When using these in
procs, be aware of that so you can change the default reference value to
something more appropriate.

