

<a name=/proc/switch>
<h2>switch proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/if>if proc</a>
<dd><a href=#/DM/preprocessor/pragma/syntax>#pragma syntax directive</a>
</dl>

<dl><dt><b>Format:</b>
  <dl><dt>switch(E)
      <dd>if(A1,A2,...) Statement1
      <dd>if(B1,B2,...) Statement1
      <dd>else Statement3
  </dl>
</dl>

<p>The "switch" instruction is a compact notation for a lengthy "else-if"
chain.  The expression E is compared to the values A1, A2, B1, B2, etc.
When a match is found, the following statement (or code block) is executed.
An optional "else" statement is run if no match is found.  Once a matching
switch condition is found, no further conditions will be tested.

<p>The values A1, A2, etc. must be constants.  As a convenience, a range of
values may be specified in the form: A1 to An.

<p>The switch instruction is MUCH more efficient than a lengthy "else-if"
chain, because the expression E is evaluated only once.  The conditional
values may be any constant expression, such as a number or text string.

<h3>Example:</h3>
<xmp>
switch (2)
  if(1)       world << "ONE"
  if(4)       world << "FOUR"
  if(2,3)     world << "TWO or THREE"
  if(5 to 10) world << "FIVE to TEN"
  else        world << "not ONE to TEN"
</xmp>

<p>This outputs:

<xmp>
TWO or THREE
</xmp>

<p>Note: Currently the compiler does not throw a warning or error if there is
a conflict between two different <tt>if</tt> blocks in a <tt>switch</tt>, e.g.
when you define <tt>if(1 to 10)</tt> and <tt>if(5 to 20)</tt> which overlap
from 5 to 10. If two different blocks could handle a given value, the choice
of which block takes over is not defined.</p>

<h3>C-like syntax</h3>

<p>Using the <a href=#/DM/preprocessor/pragma/syntax><tt>#pragma syntax</tt>
directive</a> you can change <tt>switch()</tt> to be more like other languages
such as C. This replaces the if/else instructions with <tt>case <i>value</i></tt>
and <tt>default</tt> with a trailing colon. If you don't use the
<a href=#/proc/break><tt>break</tt> statement</a> at the end of a block, it will
fall through to the next block.

<h3>Example:</h3>
<xmp>
// make this syntax change temporary
#pragma push
#pragma syntax C switch

mob/proc/Greeting(friend)
    switch(roll(6))
        case 4:
            friend << "I'm [name]. \..."
            // fall through to cases 1 and 2
        case 1,2:
            friend << "Hi!"
            break
        case 3:
            friend << "Hello there!"
        default:
            friend << "Yo."
            break

#pragma pop
</xmp>

<p>Multiple cases can be put together with either commas between the values,
or separate <tt>case</tt> statements. The <tt><i>A</i> to <i>B</i></tt> syntax
is still allowed also.

