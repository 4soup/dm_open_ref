

<a name=/DM/preprocessor/pragma/math>
<h2 byondver=516>#pragma math directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/pragma>#pragma directive</a>
<dd><a href=#/proc/sin>sin proc</a>
<dd><a href=#/proc/cos>cos proc</a>
<dd><a href=#/proc/tan>tan proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#pragma math <span class=faded>&lt;</span>fast<span class=faded>|</span>accurate<span class=faded>&gt;</span>
</dl>

<p>Chooses old-style fast math procs, or newer more accurate ones that
sacrifice a small amount of speed. This appplies to
<a class=code href=/proc/sin>sin()</a>, <a class=code href=/proc/cos>cos()</a>,
and <a class=code href=/proc/tan>tan()</a>.

<p>The reason this is necessary is because BYOND uses degrees for its angles,
but converting to radians (for the underlying math libraries) can't be done
with precision for many angles such as 90&deg;, which is &pi;/2 in radians.
When the result of the trig function is small, the angle being slightly off
from what the user intended will produce a small error in the result as well.

<p>The more-accurate procs use trigonometric identities to reduce the angle
to a more manageable range of 0 to 45&deg; (&pi;/4 radians).

<h3>Example:</h3>
<xmp>
var/angle = 90
#pragma math fast
usr << cos(angle)   // 6.12323e-17
#pragma math accurate
usr << cos(angle)   // 0
</xmp>

<p>Using <a class=code href=/DM/preprocessor/pragma/compatibility>#pragma compatibility 515</a>
will also force the fast math version.

<p>Note: For consistency, built-in compiler math for constant values uses the
same calculations that would be used for non-constant values runtime, so
<tt>cos(90)</tt> compiles as 6.12323e-17 with fast math and as 0 for accurate
math.

