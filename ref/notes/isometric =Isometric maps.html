

<a name=/{notes}/isometric toc="Isometric maps">
<h2>Isometric maps</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/client/var/dir>dir var (client)</a>
<dd><a href=#/atom/var/pixel_w>pixel_w var (atom)</a>
<dd><a href=#/atom/var/pixel_z>pixel_z var (atom)</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc var (movable atoms)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/side>Side-view maps</a>
<dd><a href=#/{notes}/topdown>Topdown maps</a>
<dd><a href=#/{notes}/HUD>HUD</a>
<dd><a href=#/{notes}/BACKGROUND_LAYER>BACKGROUND_LAYER</a>
<dd><a href=#/{notes}/EFFECTS_LAYER>EFFECTS_LAYER</a>
<dd><a href=#/{notes}/topdown_layer>TOPDOWN_LAYER</a>
</dl>

<div class="sidebar embed-image image-only">
<img src="data:image/png;charset=utf-8;base64,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">
</div>

<p>Isometric projection is a form of pseudo-3D in which the 2D icons used by
BYOND can be arranged in a way to give the appearance of three dimensions. If
you look at a map top-down, each tile on the map is a square. The map is
rotated 45&deg; clockwise and then tilted at an angle (30&deg;) so that each
square now looks like a foreshortened diamond from the viewer's perspective.
What was once north now points to the northeast end of the viewer's screen;
what was once east now points southeast to the viewer. Tiles that are more to
the south or east are "nearer" to the viewer, and tiles that are north or west
are "farther". The actual direction the map faces can be changed by using
<tt>client.dir</tt>.

<p>It is important to remember that this is an illusion of 3D, not real 3D.

<p>To use isometric mapping, set <tt>world.map_format</tt> to
<tt>ISOMETRIC_MAP</tt>. You should set <tt>world.icon_size</tt> so the tile
width is a multiple of 4 pixels. The width of the tile is highly important.
The height of your tiles should be at least half that value. BYOND uses a 2:1
isometric format, meaning that the diamond base of each tile is half as high
as its width. For example if you have a 64x64 tile size, every diamond in the
map will be 64 pixels wide by 32 high, and you have an extra 32 pixels at the
top of your icon for vertical projections like buildings. If you set the tile
size to 64x80, the base is still a 64x32 diamond and you have 48 pixels left
over for vertical structures.

<p>In this mode <tt>pixel_x</tt> and <tt>pixel_y</tt> will offset icons along the
"ground". To adjust horizontal and vertical positions, use the <tt>pixel_w</tt>
and <tt>pixel_z</tt> vars.

<h3>Layers</h3>

<p>The <tt>layer</tt> var behaves differently in isometric mode. Because some
tiles are nearer to the viewer than others, the tiles that are farther back
need to be drawn first so they are behind any tiles that should go in front of
them. So in isometric mode, the back row of tiles (a diagonal line of them) is
drawn first, followed by the next row forward, and so on. The <tt>layer</tt>
var only matters when icons overlap each other in the "physical" space, like
an obj sitting on a turf.

<p>When pixel or step offsets, or gliding, place an object on multiple turfs,
it is drawn on top of the nearer turf (assuming its layer is higher).

<p>Using icons wider than the regular tile size can have an impact on layering
as well. See <a href=#/{notes}/big-icons>Big icons</a> for more information.

<p>Because of the order in which icons are drawn, you may want to limit the
ability of an atom to cut diagonally around corners. While moving northeast
behind a dense wall, for instance, a mob might temporarily appear in front of
the wall because its pixel offsets (from gliding) temporarily put it on the
same tile as the wall. If you do not want to limit corner-cutting, a simple
workaround for this case is to give the wall a higher layer than the mob.

<p>Screen objects (in <tt>client.screen</tt>) are always drawn on top of all
isometric tiles, as is the case in other map modes as well.

<p>Since it may be desirable in some games to use a topdown map for some
situations (like a special battle map), you can add <tt>TOPDOWN_LAYER</tt> to
any atom's layer&mdash;e.g., <tt>TOPDOWN_LAYER+TURF_LAYER</tt>&mdash;to make
it appear in topdown mode. Topdown and isometric tiles really aren't meant to
be mixed, but if they do mix you'll see topdown tiles always display above
isometric tiles, just like screen objects do. The best way to use this is to
apply <tt>TOPDOWN_LAYER</tt> to every tile in a certain part of the map that
the players can't walk to.

<p>If you want to use an overlay that should not be covered by other "nearer"
icons on the map, such as a name or health meter, you can add
<tt>EFFECTS_LAYER</tt> to the overlay's layer. Icons with
<tt>EFFECTS_LAYER</tt> will draw above regular icons. Then objects with
<tt>TOPDOWN_LAYER</tt> will draw on top of everything else. However, be aware
that <tt>EFFECTS_LAYER</tt> has largely been superseded by the <tt>plane</tt>
var.

<h3>Screen size</h3>

<p>In this mode, <tt>world.view</tt> or <tt>client.view</tt> is used to define
the minimum number of map tiles you will see, <i>not</i> the screen/HUD size
which is calculated from client.view. Extra map tiles are shown to fill out
the screen size. HUD objects use screen coordinates, so 1,1 is still the lower
left.

<p>The actual HUD size is always a full number of tiles, whose size is defined
by <tt>world.icon_size</tt>. If you have a tile size of <tt>64x64</tt>, and
<tt>world.view=6</tt> (a 13x13 map), a full 13x13 diamond of map tiles will be
shown. The width of this diamond is 13 tiles. The height is only half that,
plus whatever vertical space is needed to show the icons in that area. Then
everything is rounded up to a full tile size, so the result is a 13x7-tile
screen. This is the formula you need if you want to calculate the screen size:

<xmp>
pixel_width = round(icon_width * (view_width + view_height) / 2)
pixel_height = round(icon_width * (view_width + view_height - 2) / 4) + icon_height

screen_width = round((pixel_width + icon_width - 1) / icon_width)
screen_height = round((pixel_height + icon_height - 1) / icon_height)
</xmp>

<p>If you use <tt>TOPDOWN_LAYER</tt>, any topdown sections of the map will be
limited to this same view.

